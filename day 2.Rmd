---
title: "Day 2"
author: "Iris"
date: "June 23, 2017"
output: html_document
---

<style type="text/css">

body{ /* Normal  */
      font-size: 20px;
  }
td {  /* Table  */
  font-size: 8px;
}
h1.title {
  font-size: 38px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 28px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>

#Basics.<br>
1. Basic functionality (Tools---->Keyboard shortcuts help) <br>
  + You can use the up arrow key to replay a line you already ran
  + Ctrl Enter will run a line
  + Alt +- will draw an arrow
  + Ctrl Shift M will draw a pipe operator
  + R is case sensitive so it matters if you caps or not, have a space in there or not
  + When writing code, use # in front of a comment. Frequently comment your code so you know what's happening 5 years later.
  
2. R is like a calculator
  + Operators are the same (+, -, *, /)
```{r}
1 + 1

2 - 4

5*8

8/4

```

3. Create new objects with <-
  + Object name <- value
  
```{r}
x <- 3*4
x

y <- 10/2
y

z <- x*y
z
```
  + Names should start w/ a character and be helpful (i.e., not a, b, c, but real descriptors of what the thing is)
  
4. Calling functions
  + R has several built-in functions
  + Sometimes a function you need will be in a specific package
      + Installing and Loading packages
```{r}
# installs
# install.packages("tidyverse")

# loads
library(tidyverse)
```
  + ?function will bring up a help screen for that function
      + Can see what the arguments are that you need
      + Can see the defaults for the arguments
  + Calling a function requires you type the name + the arguments it requires 
      + Demo: merge(df1, df2, by=”variable name”, all=TRUE)
```{r}
# create four variables: N, id, cond x, z, and y
# 100 observations per variable
N <- 100

# create a subject id 
id <- 1:100

# create a condition variable
cond <- rep(c("Treatment", "Control"), each = 50)

# set randomizer seed so results can be reproduced
set.seed(1234)

# drawn from random normal distribution
gratitudeT1 <- rnorm(n = N, mean = 4.5, sd = .95)
gratitudeT2 <- rnorm(n = N, mean = 5.5, sd = .95)
interdep <- 0.8 * x + rnorm(n = N, mean = 0, sd = .5)

# store in a dataframe
time1survey <- data.frame(id, cond, gratitudeT1)
time2survey <- data.frame(id, gratitudeT2, interdep)

# merge T1 and T2 by subject id
?merge()
merged_survey <- merge(x = time1survey, y = time2survey, by = "id", all = TRUE)

```
      + Demo: scale(variable, scale=FALSE)
        + scale will center your variable if the argument scale is FALSE
        + it will z-score your variable if the argument scale is TRUE
```{r}
?scale()

merged_survey$interdep_C <- scale(x = merged_survey$interdep, scale = FALSE)

# avoid having to do the $ operator all the time, with the function with()
merged_survey$interdep_C <- with(merged_survey, scale(x = interdep, scale = FALSE))
attributes(merged_survey$interdep_C) <- NULL
```
5. Useful functions for data management/transformation
  + filter()
```{r}
dplyr::filter(merged_survey, id == 90)

dplyr::filter(merged_survey, id < 90)

dplyr::filter(merged_survey, id < 9 | id == 14)

dplyr::filter(merged_survey, id < 9 & gratitudeT1 > 5)

dplyr::filter(merged_survey, id < 9 & gratitudeT1 > 5)

dplyr::filter(merged_survey, cond != "Treatment")
```
  + arrange()
    + arrange allows you to sort the data based on certain columns
```{r}
arrange(merged_survey, cond)

arrange(merged_survey, id)

```
  + select()
    + select allows you to select specific columns (for instance if you're working with a giant dataframe)
```{r}
select(merged_survey, id, interdep_C, gratitudeT1)

```
  + mutate()
    + mutate allows you to create new variables
```{r}
mutate(merged_survey,
       gratitude_mean = (gratitudeT1 + gratitudeT2)/2,
       gratitude_mean_alt = mean(x = c(gratitudeT1, gratitudeT2),
                                 na.rm = TRUE)
)

merged_survey %>% 
  rowwise() %>% 
  mutate(gratitude_mean = (gratitudeT1 + gratitudeT2)/2, 
         gratitude_mean_alt= mean(x = c(gratitudeT1, gratitudeT2),
                                  na.rm = TRUE)
  )
```
  + summarise()
    + summarise() will also allow you to create variables at the total group level
```{r}
summarise(merged_survey, mean(x = c(gratitudeT1, gratitudeT2), na.rm = TRUE))
```
   + gather()
    + puts data into long format
```{r}
merged_survey_long <- gather(data = merged_survey, key = time, value = gratitude, gratitudeT1, gratitudeT2)

# sort by Subj ID
merged_survey_long <- arrange(merged_survey_long, id)
```
 + spread() 
    + puts data into wide format
```{r}
merged_survey_wide <- spread(data = merged_survey_long, key = time, value = gratitude)

```
